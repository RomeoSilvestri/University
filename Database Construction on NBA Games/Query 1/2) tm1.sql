SELECT NICKNAME, COUNT(*) AS TOT
FROM teams t JOIN ranking r ON t.TEAM_ID=r.TEAM_ID 
WHERE W_PCT>0.5 
GROUP BY r.TEAM_ID
ORDER BY TOT DESC